<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Creed Maestro</title>
    <description>Data Analysis, Text mining, Time-series analysis, kaggle
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Fri, 05 Apr 2019 12:34:58 +0900</pubDate>
    <lastBuildDate>Fri, 05 Apr 2019 12:34:58 +0900</lastBuildDate>
    <generator>Jekyll v3.8.5</generator>
    
      <item>
        <title>Test Page</title>
        <description>&lt;p&gt;test page&lt;/p&gt;
</description>
        <pubDate>Thu, 04 Apr 2019 14:51:25 +0900</pubDate>
        <link>http://localhost:4000/ipsum/2019/04/04/test.html</link>
        <guid isPermaLink="true">http://localhost:4000/ipsum/2019/04/04/test.html</guid>
        
        
        <category>ipsum</category>
        
      </item>
    
      <item>
        <title>Titanic Kaggle with R</title>
        <description>&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;1-introduction&quot;&gt;1 Introduction&lt;/h1&gt;

&lt;p&gt;인사이트 = 데이터의 분석 + 경험과 지식의 해석&lt;/p&gt;

&lt;p&gt;인사이트의 두 가지 조건 중 첫 번째 조건을 충족하기 위해 캐글을 시작한다.&lt;/p&gt;

&lt;p&gt;우선은 필사로 시작하며, 몇 번의 필사를 거친 후에 스스로 커널을 작성할 예정이다.&lt;/p&gt;

&lt;p&gt;https://www.kaggle.com/redhorse93/r-titanic-data&lt;/p&gt;

&lt;p&gt;이번 필사는 상기 커널이며, ‘Competiton’중 ‘Titanic’에 대한 분석 과정을 담은 것이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;2-사전-준비&quot;&gt;2 사전 준비&lt;/h1&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;21-package&quot;&gt;2.1 Package&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# Data input, assement: 데이터 로드, 확인
library(tidyverse)     # R의 통합 패키지로 여기서는 'readr'패키지를 쓰기 위함이다.
library(descr)         # descr::CrossTable() - 범주별 빈도수, 비율 수치로 확인

# Visualization
library(VIM)           #Missing values assement use by VIM::aggr()
#library(ggplot2)      #Used in almost visualzation 원문에선 따로 패키지를 부르지만, 
                       #tidyverse내에 포함된 패키지로 여기선 주석으로 처리한다.
library(RColorBrewer)  # plot의 color 설정
library(scales)        # plot setting - x, y 축 설정

# Feature Engineering, Data Pre-processing
#library(tidyverse)    # 아래 패키지는 모두 포함하기에 주석 처리한다.
#library(dplyr)        # Feature Engineering &amp;amp; Data Pre-processing
#library(purrr)        # Check missing values
#library(tidyr)        # tidyr::gather()

# Model generation
library(randomForest)  # For Random Forest Modeling

# Model validation :   원문 커널에선 생략된 내용이다.
#library(caret)        # caret::confusionMatrix()
#library(ROCR)         # Plotting ROC Curve
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;multiplot-function-generation&quot;&gt;multiplot() function generation&lt;/h3&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;한 화면에 여러개 ‘plot’들을 표기하기 위해 ‘multiplot()’ 함수를 사용한다.&lt;/p&gt;

&lt;p&gt;하지만 원문의 필자는 어떤 문제가 생겨 ‘multiplot()’함수를 사용할 수 없어,&lt;/p&gt;

&lt;p&gt;‘CRAN’을 참고하여 ‘multiplot()’함수를 생성해서 사용했다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.

multiplot &amp;lt;- function(..., plotlist = NULL, file, cols = 1, layout = NULL) {
  library(grid)
  
  # Make a list from the... arguments and plotlist
  plots &amp;lt;- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL&amp;lt; then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout &amp;lt;- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i, j matrix positions of the regions that contain this subplot
      matchidx &amp;lt;- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
 }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;22-raw-data-import--데이터-원본-로드&quot;&gt;2.2 Raw data import : 데이터 원본 로드&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘Model’을 생성하는데 쓰는 ‘train’ data와 실제 예측에 쓰는 ‘test’ data가 분리되어 있다.&lt;/p&gt;

&lt;p&gt;2개 data를 로드한 후에 묶을 예정이다.&lt;/p&gt;

&lt;p&gt;분리된 data를 묶는 이유는 모델링에 사용되는 입력 변수들을 Feature Engineering,&lt;/p&gt;

&lt;p&gt;Pre-processing 할 때 동일하게 작업하기 위해서이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train &amp;lt;- readr::read_csv(&quot;./input/train.csv&quot;)

test  &amp;lt;- readr::read_csv(&quot;./input/test.csv&quot;)

full  &amp;lt;- dplyr::bind_rows(train, test)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘read_csv()’가 ‘read.csv’보다 로딩 속도가 조금 더 빠르기에 이 함수를 사용한다.&lt;/p&gt;

&lt;p&gt;주의점은 문자열(‘Character’)와 요인 변수(‘Factor’)를 구별하지 않고 모두 ‘Chr’로 저장된다.&lt;/p&gt;

&lt;p&gt;데이터를 ‘full’로 묶으면서 ‘rbind()’대신 ‘bind_rows()’를 쓴 이유는 ‘test’에는&lt;/p&gt;

&lt;p&gt;‘Titanic competition’의 종속변수(타겟변수, Y)인 ‘Survived’가 없어서 데이터의&lt;/p&gt;

&lt;p&gt;차원(‘dimention’)이 맞지 않다. 그래서 ‘rbind()’로는 병합되지 않기에 후자를 썻다.&lt;/p&gt;

&lt;p&gt;‘bind_rows()’는 ‘test’의 ‘Survived’를 ‘NA’로 처리하면서 하나로 병합이 가능하다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;23-변수-의미-설명&quot;&gt;2.3 변수 의미 설명&lt;/h2&gt;

&lt;p&gt;각 변수의 의미와 지정한 속성은 아래 표와 같다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;변수명&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;해석(의미)&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Type&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;PassengerID&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객을 구별하는 고유 ID number&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Int&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Survived&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객의 생존 여부를 나타내며 생존은 1, 사망은 0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Pclass&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;선실의 등급으로서 1등급(1)부터 3등급(3)까지 3개 범주&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ord.Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객의 이름&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Sex&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객의 성별&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Age&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객의 나이&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Numeric&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;SibSp&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;각 승객과 동반하는 형제 또는 배우자의 수를 설명하는 변수이며 0부터 8까지 존재&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Parch&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;각 승객과 동반하는 부모님 또는 자녀의 수를 설명하는 변수이며 0부터 9까지 존재&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Ticket&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객이 탑승한 티켓에 대한 문자열 변수&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Fare&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승객이 지금까지 여행하면서 지불한 금액에 대한 변수&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Numeric&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Cabin&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;각 승객의 선실을 구분하는 변수이며 범주와 결측치가 너무 많다.&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Embarked&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승선항, 출항지를 나타내며 C, Q, S 3개 범주&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Factor&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;표보다 더 상세한 정보는 나무위키의 타이타닉 관련 링크를 참조 바란다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://namu.wiki/w/RMS%20%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89&quot;&gt;링크&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full &amp;lt;- full %&amp;gt;% 
  dplyr::mutate(Survived = factor(Survived),
                Pclass = factor(Pclass, ordered = T),
                Name = factor(Name),
                Sex = factor(Sex),
                Ticket = factor(Ticket),
                Cabin = factor(Cabin),
                Embarked = factor(Embarked))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;3-탐색적-데이터-분석eda--exploratory-data-analysis&quot;&gt;3 탐색적 데이터 분석(EDA : Exploratory Data Analysis)&lt;/h1&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;결측치, 이상치 외 data 확인 작업 과정&lt;/p&gt;

&lt;p&gt;여러 함수와 시각화를 사용하여 확인&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;31-수치값을-활용한-data-확인&quot;&gt;3.1 수치값을 활용한 data 확인&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘head()’와 ‘summary()’로 data 확인&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;311-head&quot;&gt;3.1.1 head()&lt;/h3&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;head(full, 10)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;결과를 보면 ‘Age’에 결측치가 있다.&lt;/p&gt;

&lt;p&gt;‘Age’외 다른 변수들엔 결측치가 없는지는 추후에 확인한다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;312-str&quot;&gt;3.1.2 str()&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;str(full)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;data는 12열(변수) 1309행(관측치.train: 891, test: 418)이다.&lt;/p&gt;

&lt;p&gt;그 외 각 변수의 속성과 ‘factor’ 속성의 변수들에 범주가 몇 개 인지도 확인 가능하다.&lt;/p&gt;

&lt;p&gt;‘head()’ 결과 ‘Age’외 ‘Cabin’ 에도 결측치가 있음을 알 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;313-summary&quot;&gt;3.1.3 summary()&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;summary(full)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
‘summary()’는 많은 것을 알 수 있다.&lt;/p&gt;

&lt;p&gt;수량형(Integer, Numeric) 변수들의 대표값, 범주형(Factor) 변수들의 범주 갯수,&lt;/p&gt;

&lt;p&gt;범주별 관측치 갯수까지 확인이 가능하다.&lt;/p&gt;

&lt;p&gt;아래 사항들은 변수에 대한 간략 설명이다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Survived&lt;/code&gt; : 이번 &lt;code class=&quot;highlighter-rouge&quot;&gt;competition&lt;/code&gt;의 타겟 변수이며 418개의 결측치는 Test data 때문이다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Pclass&lt;/code&gt; : 1등급, 2등급, 3등급으로 범주가 세 개인데 3등급 승객이 가장 많다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Name&lt;/code&gt; : 이름이 비슷한 사람들이 있다. 따라서 혼자 탄 승객도 있지만 가족들과 
         같이 탑승한 승객도 있음을 알 수 있다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Sex&lt;/code&gt; : 남성이 여성보다 2배 가까이 더 많다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Age&lt;/code&gt; : 0.17부터 80세까지 있는데 0.17을 잘못 기입한 이상치 인건지 확인이 필요해보이며,
         263개의 결측치가 존재한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SibSp&lt;/code&gt; : 0부터 8까지 있는데 3분위수가 1이므로 부부 혹은 형제와 함께 
           Titanic호에 탑승했음을 알 수 있다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Parch&lt;/code&gt; : 0부터 9까지 있지만 3분위수가 0인 것을 통해서 부모, 자녀들과 함께 탄
           승객들이 거의 없음을 알 수 있다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SibSp&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;Parch&lt;/code&gt;는 모두 가족관계를 나타내는 변수들이다. 이를 활용하여 가족 중
  누가 탔는지는 모르지만 동승한 인원이 총 몇 명인지 구하고, 
  그것을 바탕으로 가족의 규모를 나타내는 &lt;code class=&quot;highlighter-rouge&quot;&gt;FamilySized&lt;/code&gt; 라는 범주형 파생변수도 만들 것이다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ticket&lt;/code&gt; : &lt;code class=&quot;highlighter-rouge&quot;&gt;3.1.2 str()&lt;/code&gt;의 결과와 같이보면 완전히 동일한 티켓을 가진 승객들도 있고, 
  티켓이 일정 부분만 겹치는 승객들도 있고 아예 다른 티켓을 가진 승객이 있음을 알 수 있다. 
  이것을 이용해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;ticket.size&lt;/code&gt;라는 파생변수를 만들 것이다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Fare&lt;/code&gt; : 0부터 512까지 있고 1개의 결측치가 있다. 
  3분위수가 31.275이지만 최댓값이 512라 갭이 너무 커서 확인해 봐야겠다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Cabin&lt;/code&gt; : 총 12개 Feature들 중에서 가장 많은(1014개) 결측치를 갖고 있다. 
  배의 구역을 나타내는 변수인데 활용할 방법이 없다면 버려야 될 것 같다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Embarked&lt;/code&gt; : 총 3개 범주로 구성이 되어있고 S가 가장 많으며 2개의 결측치가 있다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;데이터를 탐색하기 전에 ‘summary()’, ‘str()’ 같은 관측 함수들로 기본 정보를 확인하면 좋다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;32-missing-value&quot;&gt;3.2 Missing value&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;변수의 결측치 여부와 있을 시 얼마나 존재하는지 확인하는 과정.&lt;/p&gt;

&lt;p&gt;‘dplyr’, ‘ggplot2’,’ VIM’ 패키지들로 수치를 확인 후 시각화로 나타낼 예정이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;321-vim-packages&quot;&gt;3.2.1 VIM packages&lt;/h3&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;VIM::aggr(full, prop = FALSE, combined = TRUE, numbers = TRUE, 
          sortVars = TRUE, sortCombs = TRUE)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;322-tidyverse-packages&quot;&gt;3.2.2 tidyverse packages&lt;/h3&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘VIM’ 패키지가 아닌, ‘tidyverse’로도 결측치를 확인할 수 있다.&lt;/p&gt;

&lt;p&gt;‘dplyr’로 변수별 결측치 비율을 알아본다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full %&amp;gt;% 
  dplyr::summarise_all(funs(sum(is.na(.))/n()))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;확인 결과 ‘Age’,’Cabin’외 ‘Survived’, ‘Fare’,’Embarked’에도 결측치가 있음을 알 수 있다.&lt;/p&gt;

&lt;p&gt;결측치는 비율로 확인하는 방법도 있지만, 시각화를 통해 확인할 수도 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# 각 feature의 결측치 비율 계산 -&amp;gt; Data Frame 속성 but 1행 12열 구조로 되어있다.
missing_values &amp;lt;- full %&amp;gt;% 
  dplyr::summarise_all(funs(sum(is.na(.))/n()))

# 위에서 구한 missing_values를 12x2 data frame으로 생성
missing_values &amp;lt;- tidyr::gather(missing_values,
                                key = 'feature', value = 'missing_pct')

# missing_values를 활용한 시각화
missing_values %&amp;gt;% 
  # Aesthetic setting: missing_pct 내림차순으로 정렬
  ggplot(aes(x = reorder(feature, missing_pct), y = missing_pct)) +
  # Bar plot
  geom_bar(stat = 'identity', fill = 'red') +
  # Title generation
  ggtitle('Rate of missing values in each features') +
  # Title detail setting
  theme(plot.title = element_text(face = 'bold',    #글씨체
                                  hjust = 0.5,       # Horizon(가로비율) 
                                  size = 15, 
                                  color = 'darkblue')) +
  # x, y axis label setting
  labs(x = 'Feature names', y = 'Rate') + 
  # Plot의 x, y 축 변환
  coord_flip()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
확인 결과 12개 변수중 총 5개에 결측치가 존재하며, ‘Cabin’,’Age’,’Embarked’,’Fare’&lt;/p&gt;

&lt;p&gt;순으로 결측치가 많음을 알 수 있다.(‘Survived’는 test data결합시 생긴 값으로 제외)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;시각화로 ‘feature’를 분석, 탐색해 보자.&lt;/p&gt;

&lt;h2 id=&quot;33-age&quot;&gt;3.3 Age&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;age.p1 &amp;lt;- full %&amp;gt;% 
  ggplot(aes(Age)) +
  # 히스토그램 작성, 설정
  geom_histogram(breaks = seq(0, 80, by = 1), #간격 설정
                 col = 'red',     # 막대 경계선 색깔
                 fill = 'green',  # 막대 채우기 색깔
                 alpha = .5) +     # 막대 투명도 50%
  # Plot title
  ggtitle('All Titanic passengers age histogram') +
  theme(plot.title = element_text(face = 'bold',   #글씨체
                                    hjust = 0.5,  #Horizon(가로비율)
                                    size = 15,
                                    color = 'darkblue'))
  
age.p2 &amp;lt;- full %&amp;gt;% 
  # test data set의 Survived == NA 인 값들 제외
  filter(!is.na(Survived)) %&amp;gt;% 
  ggplot(aes(Age, fill = Survived)) +
  geom_density(alpha = .5) +
  ggtitle('Titanic passengers age density plot') +
  theme(plot.title = element_text(face = 'bold', hjust = 0.5,
                                  size = 15, color = 'darkblue'))
  
  # multiplot layout 형식 지정
  multi.layout = matrix(c(1, 1, 2, 2), 2, 2, byrow = T)
  
  # 위에서 생성한 2개의 그래프를 한 화면에 축력
  multiplot(age.p1, age.p2, layout = multi.layout)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;34-pclass&quot;&gt;3.4 Pclass&lt;/h2&gt;

&lt;p&gt;각 ‘Pclass’에 해당하는 탑승객의 빈도수 시각화.&lt;/p&gt;

&lt;p&gt;‘dplyr’패키지 활용하여 ‘Pclass’ 별로 그룹핑,&lt;/p&gt;

&lt;p&gt;범주별 빈도수를 나타내는 ‘data frame’ 생성한 후 ‘ggplot’으로 시각화&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full %&amp;gt;% 
  # dplyr::group_by(), summarize() 를 이용해서 Pclass 빈도수 구하기
  group_by(Pclass) %&amp;gt;% 
  summarize(N = n()) %&amp;gt;% 
  # Aesthetic setting
  ggplot(aes(Pclass, N)) +
  geom_col() +
  # Pclass 빈도수 plot에 출력
  geom_text(aes(label = N),  #Plot의 y에 해당하는 N(빈도수) 매핑
            size = 5,   #글씨 크기
            vjust = 1.2,  #Vertical(가로) 위치 설정
            color = '#FFFFFF') +   #글씨 색깔 : 흰색
  # Plot title
  ggtitle(&quot;Number of each Pclass's passenger&quot;) +
  # Title setting
  theme(plot.title = element_text(face = 'bold', hjust = 0.5, size = 15)) +
  # x, y axis name change
  labs(x = 'Pclass', y = 'Count')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;3등급 객실에 탑승한 승객이 가장 많이 사망.&lt;/p&gt;

&lt;p&gt;객실 등급과 생존율간의 연관성은 ‘chapter5’에서 다룰 예정&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;35-fare&quot;&gt;3.5 Fare&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;티켓값 ‘Fare’ 시각화, histogram &amp;amp; boxplot으로 표현&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;  # Histogram
  Fare.p1 &amp;lt;- full %&amp;gt;% 
    ggplot(aes(Fare)) +
    geom_histogram(col = 'yellow',
                   fill = 'blue',
                   alpha = .5) +
  ggtitle('Histogram of passengers Fare') +
  theme(plot.title = element_text(face = 'bold', hjust = 0.5, size = 15))

  # Boxplot
  Fare.p2 &amp;lt;- full %&amp;gt;% 
    filter(!is.na(Survived)) %&amp;gt;% 
    ggplot(aes(Survived, Fare)) +
    # 관측치는 회색점, 중복되는 부분은 흩뿌려서 나타냄
    geom_jitter(col='gray') +
    # boxplot : xnaudeh 50%
    geom_boxplot(alpha = .5) +
    ggtitle('Boxplot of passengers Fare') +
    theme(plot.title = element_text(face = 'bold', hjust = 0.5, size= 15))
  
  # multiplot layout 형식 지정
  mulit.layout = matrix(c(1, 1, 2, 2), 2, 2)
  
  # 위에서 생성한 2개 그래프를 한 화면에 출력
  multiplot(Fare.p1, Fare.p2, layout = multi.layout)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;생존자들이 사망한 승객들보다 ‘Fare’가 더 높지만 그렇게 큰 차이는 아님을 알 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;36-sex&quot;&gt;3.6 Sex&lt;/h2&gt;

&lt;p&gt;성별간 생존율 차이의 시각화&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;sex.p1 &amp;lt;- full %&amp;gt;% 
  dplyr::group_by(Sex) %&amp;gt;% 
  summarize(N = n()) %&amp;gt;% 
  ggplot(aes(Sex, N)) +
  geom_col() +
  geom_text(aes(label = N), size = 5, vjust = 1.2, color = &quot;#FFFFFF&quot;) + 
  ggtitle(&quot;Bar plot of Sex&quot;) +
  labs(x = &quot;Sex&quot;, y = &quot;Count&quot;)

sex.p2 &amp;lt;- full[1:891, ] %&amp;gt;% # 892행 이후부터는 'test' data로 생존율이 NA값임.
  ggplot(aes(Sex, fill = Survived)) +
  geom_bar(position = 'fill') +
  scale_fill_brewer(palette = &quot;Set1&quot;) +
  scale_y_continuous(labels = percent) +
  ggtitle('Survival Rate by Sex') +
  labs(x = 'Sex', y = 'Rate')

multi.layout = matrix(rep(c(1, 2), times = 2), 2, 2, byrow = T)

multiplot(sex.p1, sex.p2, layout = multi.layout)

mosaicplot(Survived ~ Sex,
           data = full[1:891, ], col = TRUE,
           main = 'Survival rate by passengers gender')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;그래프를 보면, 인원은 남성이 더 많지만, 생존율은 여성이 더 높음을 알 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;4-feature-engineering--data-pre-processing&quot;&gt;4 Feature Engineering &amp;amp; Data Pre-processing&lt;/h1&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘Chapter 3 EDA’의 내용을 바탕으로 결측치를 채우고, 파생변수를 생성하는 과정&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;41-age---agegroup&quot;&gt;4.1 Age -&amp;gt; Age.Group&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full &amp;lt;- full %&amp;gt;%
  # 결측치 제외한 값들의 평균으로 결측치를 채움
  mutate(Age = ifelse(is.na(Age), mean(full$Age, na.rm = TRUE), Age),
         # Age 값에 따라 범주형 파생 변수 Age.Group 생성)
         Age.Group = case_when(Age &amp;lt; 13 ~ 'Age.0012',
                               Age &amp;gt;= 13 &amp;amp; Age &amp;lt; 18 ~ 'Age.1317',
                               Age &amp;gt;= 18 &amp;amp; Age &amp;lt; 60 ~ 'Age.1859',
                               Age &amp;gt;= 60 ~ 'Age.60inf'),
         # Chr 속성을 Factor로 변환
         Age.Group = factor(Age.Group))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;42-sibsp--parch---familysized&quot;&gt;4.2 SibSp &amp;amp; Parch -&amp;gt; FamilySized&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full &amp;lt;- full %&amp;gt;% 
  # SibSp, Parch와 1(본인)을 더해서 FamilySize라는 파생변수를 먼저 생성
  mutate(FamilySize = .$SibSp + .$Parch + 1,
         # FamilySize 의 값에 따라서 범주형 파생 변수 FamilySized를 생성
         FamilySized = dplyr::case_when(FamilySize == 1 ~ &quot;Single&quot;,
                                        FamilySize &amp;gt;= 2 &amp;amp; FamilySize &amp;lt; 5 ~ &quot;Small&quot;,
                                        FamilySize &amp;gt;= 5 ~ &quot;Big&quot;),
         # Chr 속성인 FamilySized를 factor로 변환
         # 집단 규모 크기에 따라 levels를 새로 지정
         FamilySized = factor(FamilySized, levels = c(&quot;Single&quot;, &quot;Small&quot;, &quot;Big&quot;)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
‘SibSp’, ‘Parch’를 이용해서 ‘FamilySized’를 생성
두 개의 변수를 하나로 줄이면 모델이 단순화가 되어 파악이 용이
(ex. 키 &amp;amp; 체중으로 BMI 지수 산출)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;43-name--sex---title&quot;&gt;4.3 Name &amp;amp; Sex -&amp;gt; title&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‘Chapter 3.6 Sex’의 결과를 봤을 때 여성의 생존율이 남성보다 높음을 알 수 있다.
따라서 ‘Name’에서 ‘성별과 관련된 이름만을 추출해서 범주화 시키면 쓸모 있지 않을까?’
는 생각이 들어 그렇게 함수 생성
‘full’ data에서 ‘Name’ 열만 추출하여 ‘title’로 저장&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# Name 열 추출
title &amp;lt;- full$Name

# 정규표현식과 gsub()을 이요해서 성별과 관련성이 높은 이름만 추출해서 title 벡터로 저장
title &amp;lt;- gsub(&quot;^.*, (.*?)\\..*$&quot;, &quot;\\1&quot;, title)

# 위에서 저장한 title 벡터를 full에 파생변수로 저장
full$title &amp;lt;- title
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;
‘Unique’한(고유한) ‘title’에는 어떤 것들이 있는지 확인&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;unique(full$title)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
총 18개의 범주가 확인됨.
이대로 쓸 경우 모델의 복잡도가 높아지기에(특히 Tree based model) 범주를 줄일 예정.
그 전에 ‘descr’ 패키지를 이용해서 각 범주별 빈도수와 비율을 확인.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# 범주별 빈도수, 비율 확인
descr::CrossTable(full$title)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;18개나 되는 범주들의 빈도수와 비율이 너무 제각각.
총 5개 범주로 단순화&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# 5개 범주로 단순화
full &amp;lt;- full %&amp;gt;% 
  # '%in%' 대신 '=='을 쓸 시 Recycling Rule 때문에 원하는대로 되지 않음.
  mutate(title = ifelse(title %in% c('Mlle', 'Ms', 'Lady', 'Dona'), 'Miss', title),
         title = ifelse(title == 'Mme', 'Mrs', title),
         title = ifelse(title %in% c('Capt', &quot;col&quot;,'Major', 'Dr', 'Rev', 'Don',
                                     'Sir', &quot;the Countess&quot;, 'Jonkheer'), &quot;officer&quot;, title),
         title = factor(title))

# 파생변수 생성 후 각 범주별 빈도수, 비율 확인
descr::CrossTable(full$title)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;44-ticket---ticketsize&quot;&gt;4.4 Ticket -&amp;gt; ticket.size&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;
‘Chapter 3.1.3 Summary()’ 확인 결과 승객은(‘train’, ‘test’합쳐서 모두) 1309명이다.
하지만 티켓은 모두 달라야 하지만 그렇지 않다.
‘summary()’와 ‘unique()’ 결과값을 확인하자&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# 'unique'한 범주의 갯수만 파악하려고 length()를 사용
length(unique(full$Ticket))

# 모두 출력하면 지저분하니 10개만 출력
head(summary(full$Ticket), 10)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
결측치가 없는 ‘feature’인데 unique한 티켓이 929개 뿐이다.
‘CA. 2343’인 티켓은 11명이나 같다.
어떤 승객들인지 확인해보자.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full %&amp;gt;% 
  # 티켓이 일치하는 11명의 승객들 필터링
  filter(Ticket == 'CA. 2343') %&amp;gt;% 
  # 몇 가지 변수 확인
  select(Pclass, Name, Age, FamilySized)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
이 티켓의 11명은 모두 같은 가족 &amp;amp; 형제인 것을 알 수 있다.
티켓이 완전히 동일한 승객들이 있는 반면 일부분만 일치하는 승객들도 있다.
티켓의 Unique 넘버 갯수를 나타내는 ‘ticket.unique’ 파생변수를 만들고,
‘ticket.unique’를 바탕으로 3개 범주를 갖는 ‘ticket.size’ 파생변수도 만든다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# ticket.unique가 모두 0이라고 저장
ticket.unique &amp;lt;- rep(0, nrow(full))

# Ticket Feature에서 unique한 것들만 추출해서 tickets 벡터에 저장
tickets &amp;lt;- unique(full$Ticket)

# 반복문을 중첩 활용해서 티켓이 같은 승객들만 선별 후, 각 티켓의 길이를 추출하여 저장
for (i in 1:length(tickets)) {
  current.ticket &amp;lt;- tickets[i]
  party.indexes &amp;lt;- which(full$Ticket == current.ticket)
    # For loop 중첩
    for (k in 1:length(party.indexes)) {
      ticket.unique[party.indexes[k]] &amp;lt;- length(party.indexes)
    }
  }

# 위에서 계산한 ticket.unique를 파생변수로 저장
full$ticket.unique &amp;lt;- ticket.unique

# ticket.unique에 따라 세가지 범주로 나눠서 ticket.size 변수 생성
full &amp;lt;- full %&amp;gt;% 
  mutate(ticket.size = case_when(ticket.unique == 1 ~ 'Single',
                                 ticket.unique &amp;lt; 5 &amp;amp; ticket.unique &amp;gt;= 2 ~ 'Small',
                                 ticket.unique &amp;gt;= 5 ~ 'Big'),
         ticket.size = factor(ticket.size, 
                              levels = c('Single','Small','Big')))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;45-embarked&quot;&gt;4.5 Embarked&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;결측치가 2개 있던 ‘feature’임
‘Embarked’의 경우 3개 범주 중에서 가장 최반값인 ‘S’로 치환&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full$Embarked &amp;lt;- replace(full$Embarked,               # 치환할 Data$feature 지정
                         which(is.na(full$Embarked)), # 결측치 찾기
                         'S')                         # 치환할 값 지정
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;46-fare&quot;&gt;4.6 Fare&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;
‘Fare’의 경우 결측치가 유일하게 1개임
‘Chapter 3.5 Fare’를 바탕으로 결측치를 0으로 치환&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;full$Fare &amp;lt;- replace(full$Fare, which(is.na(full$Fare)), 0)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;– 데이터 전처리 완료–
이후, 지금까지 만든 파생변수들을 탐색하며 모델 생성에 사용할 변수 선별
‘Feature selection’&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;5-relationship-to-target-feature-survived--feature-selection&quot;&gt;5 Relationship to target feature ‘Survived’ &amp;amp; Feature selection&lt;/h1&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;각 변수와 생존율간 연관성 파악. 
‘test’는 생존.사망이 NA기 때문에 제외하고,
생존과 사망 여부를 알 수 있는 ‘train’ data set만 사용함&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;50-data-set-split&quot;&gt;5.0 Data set split&lt;/h2&gt;

&lt;p&gt;전처리 끝난 ‘full’ data를 ‘train’, ‘test’로 분할&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# feature selection 전이므로 모든 변수들을 선택
train &amp;lt;- full[1:891, ]

test &amp;lt;- full[892:1309, ]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;51-pclass&quot;&gt;5.1 Pclass&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(Pclass, fill = Survived)) +
  geom_bar(position = 'fill') +
  # plot 테마 설정 : 조금 더 선명한 색깔로 변환
  scale_fill_brewer(palette = 'Set1')  +
  # Y axis setting
  scale_y_continuous(labels = percent) +
  # x, y 축 이름과 plot의 main title, sub title 설정
  labs(x = 'Pclass', y = &quot;Rate&quot;,
       title = &quot;Bar plot&quot;, subtitle = 'How many people survived in each Pclass?')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;52-sex&quot;&gt;5.2 Sex&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;** ‘Chapter 3.6 Sex와 동일’ **&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;mosaicplot(Survived ~ Sex,
           data = train, col = TRUE,
           main = 'Survival rate by passengers gender')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;53-embarked&quot;&gt;5.3 Embarked&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(Embarked, fill = Survived)) +
  geom_bar(position = 'fill') +
  scale_fill_brewer(palette = 'Set1') +
  scale_y_continuous(labels = percent) +
  labs(x = 'Embarked', y = 'Rate',
       title = 'Bar plot', subtitle = 'How many people survied in each Embarked?')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;54-familysized&quot;&gt;5.4 FamilySized&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(FamilySized, fill = Survived)) + 
  geom_bar(position = 'fill') +
  scale_fill_brewer(palette = 'Set1') +
  scale_y_continuous(labels = percent) +
  labs(x = &quot;FamilySized&quot;, y = 'Rate',
       title = 'Bar plot', subtitle = 'Survival rate by FamilySized')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;동승한 인원수에 따라 생존율에 차이가 있고, ‘FamilySized’와 ‘Survived’는 
비선형 관계임을 알 수 있다.&lt;/p&gt;

&lt;h2 id=&quot;55-agegroup&quot;&gt;5.5 Age.Group&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(Age.Group, fill = Survived)) +
  geom_bar(position = 'fill') +
  scale_fill_brewer(palette = 'Set1') +
  scale_y_continuous(labels = percent) +
  labs(x = 'Age group', y = 'Rate',
       title = 'Bar plot', subtitle = 'Survivla rate by Age group')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;56-title&quot;&gt;5.6 title&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(title, fill = Survived)) +
  geom_bar(position = 'fill') +
  scale_fill_brewer(palette = 'Set1') +
  scale_y_continuous(labels = percent) + 
  labs(x = 'title', y = 'Rate',
       title = 'Bar plot', subtitle = 'Survival rate by passengers title')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;57-ticketsize&quot;&gt;5.7 ticket.size&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;train %&amp;gt;% 
  ggplot(aes(ticket.size, fill = Survived)) +
  geom_bar(position = 'fill') + 
  scale_fill_brewer(palette = 'Set1') + 
  scale_y_continuous(labels = percent) +
  labs(x = 'ticket.size', y = 'Rate',
       title = 'Bar plot', subtitle = 'Survival rate by ticket.size')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;58-description-of-actual-used-features&quot;&gt;5.8 Description of actual used features&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;생성한 파생변수들의 유효성을 확인했으니, 실제로 사용할 변수들만 선별해서 저장.
실제 선택한 변수들에 대한 간단한 설명&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;변수명&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Type&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;설명&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Survived&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Target feature, 생존 == 1, 사망 == 0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Sex&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;성별, &lt;code class=&quot;highlighter-rouge&quot;&gt;male&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;female&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Pclass&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;선실 등급, 1등급(1), 2등급(2), 3등급(3)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Embarked&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;승선항, 사우샘프턴(S), 셸부르(C), 퀸즈타운(Q)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;FamilySized&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;가족의 규모, &lt;code class=&quot;highlighter-rouge&quot;&gt;SibSp&lt;/code&gt;와 &lt;code class=&quot;highlighter-rouge&quot;&gt;Parch&lt;/code&gt;를 이용해서 만든 파생변수, 범주는 3개&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;Age.Group&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;연령대, &lt;code class=&quot;highlighter-rouge&quot;&gt;Age&lt;/code&gt;를 이용해서 만든 파생변수, 범주는 4개&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;title&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;이름의 일부분, &lt;code class=&quot;highlighter-rouge&quot;&gt;Name&lt;/code&gt;을 이용해서 만든 파생변수, 범주는 5개&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;ticket.size&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;factor&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;티켓의 고유한 부분의 길이, &lt;code class=&quot;highlighter-rouge&quot;&gt;ticket&lt;/code&gt;을 이용해서 만든 파생변수, 범주는 3개&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# Id number 제외하고 실제로 사용할 7개 입력 변수와 1개 타겟 변수를 선택, 저장
train &amp;lt;- train %&amp;gt;% 
  select('Pclass', 'Sex', 'Embarked', 'FamilySized', 'Age.Group', 'title',
         'ticket.size', 'Survived')

# Submit을 위해 Id 열 추출하여 ID에 저장
ID &amp;lt;- test$PassengerId

# Id와 Survived를 제외한 나머지 6개 변수 선택, 저장
test &amp;lt;- test %&amp;gt;% 
  select('Pclass', 'Sex', 'Embarked', 'FamilySized', 'Age.Group','title','ticket.size')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;6-machine-learning-model-generation&quot;&gt;6 Machine learning model generation&lt;/h1&gt;

&lt;p&gt;&lt;br /&gt;
‘train’ data set으로 기계학습
‘train’, ‘validation’, ‘test’로 교차검증(‘Cv’)으로 선택을 하는게 맞지만,여기서는 
‘RandomForest’만을 생성하여 ‘test’ data를 예측하고 ‘Submit’용 data까지만 생성.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;61-random-forest-model-generation&quot;&gt;6.1 Random Forest model generation&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# 재현성을 위해 seed number를 설정
set.seed(1901)

titanic.rf &amp;lt;- randomForest(Survived ~ ., data = train, importance = T, ntree = 2000)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;62-feature-importance-check&quot;&gt;6.2 Feature importance check&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;importance(titanic.rf)

varImpPlot(titanic.rf)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;63-predict-test-data-and-create-submit-data&quot;&gt;6.3 Predict test data and create submit data&lt;/h2&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;# Prediction
pred.rf &amp;lt;- predict(object = titanic.rf, newdata = test, type = &quot;class&quot;)

# Data frame generation
submit &amp;lt;-  data.frame(PassengerID = ID, Survived = pred.rf)

# Write the submit data frame to file: setwd()로 지정해놓은 폴더에 csv로 생성됨.
write.csv(submit, file = './titanic_submit.csv', row.names = F)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;– 완 –&lt;/p&gt;

&lt;h1 id=&quot;7-reference--참고문헌&quot;&gt;7 Reference : 참고문헌&lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/mrisdal&quot;&gt;‘Megan Risdal’ titanic kernel&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/headsortails&quot;&gt;‘Heads or Tails’ titanic kernel&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/hiteshp/head-start-for-data-scientist&quot;&gt;Hitesh palamada - Head Start for Data Scientist&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://namu.wiki/w/RMS%20%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89&quot;&gt;나무위키 - RMS 타이타닉&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;R을 활용한 데이터 과학(인사이트), Garrett Grolemund, Hadley Wickham 지음, 김설기, 최혜민 옮김, 978-89-6626-235-9 : tidyverse를 이해하기 가장 좋은 책&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://statkclee.github.io/r-novice-gapminder/14-tidyr-kr.html&quot;&gt;tidyr::gather() - Software Carpentry&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;머신러닝 탐구생활(비제이퍼블릭), 정권우 지음, 979-11-86697-69-6 : Data 분석 노트(표) 작성하는데 많은 도움을 받았습니다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;8-원문-링크&quot;&gt;8. 원문 링크&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/redhorse93/r-titanic-data&quot;&gt;원문 링크&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 12 Mar 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/kaggle/2019/03/12/Titanic_Kaggle_%ED%95%84%EC%82%AC.html</link>
        <guid isPermaLink="true">http://localhost:4000/kaggle/2019/03/12/Titanic_Kaggle_%ED%95%84%EC%82%AC.html</guid>
        
        <category>Kaggle</category>
        
        
        <category>Kaggle</category>
        
      </item>
    
  </channel>
</rss>
